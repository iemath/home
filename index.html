<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trung Tâm IEMATH</title>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #1e90ff;
            --secondary-color: #0066cc;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #f0f4f8;
            --dark-color: #2c3e50;
            --text-color: #34495e;
            --border-radius: 10px;
            --box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: linear-gradient(to bottom, #f0f4f8, #d9e6f2);
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1300px;
            margin: 0 auto;
            padding: 30px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px 0;
            text-align: center;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            box-shadow: var(--box-shadow);
        }

        header h1 {
            margin: 0;
            font-size: 3rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .intro-text {
            font-size: 1.2rem;
            margin-top: 10px;
            opacity: 0.9;
        }

        nav {
            background-color: #fff;
            padding: 15px 0;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 20px;
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            gap: 30px;
        }

        nav ul li {
            display: inline;
        }

        nav ul li a {
            text-decoration: none;
            color: var(--primary-color);
            font-weight: 500;
            padding: 12px 25px;
            border-radius: 5px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        nav ul li a:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        nav ul li a i {
            font-size: 1.2rem;
        }

        .banner {
            background: linear-gradient(135deg, #ffd700, #ffcc00);
            color: var(--text-color);
            text-align: center;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 500;
            box-shadow: var(--box-shadow);
        }

        .section {
            display: none;
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 20px;
        }

        .section.active {
            display: block;
        }

        .home-section {
            text-align: center;
        }

        .home-section h2 {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .home-section p {
            font-size: 1.1rem;
            color: #666;
            max-width: 800px;
            margin: 0 auto 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
            background-color: #f9f9f9;
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: var(--primary-color);
            outline: none;
            background-color: #fff;
        }

        .form-group input[required] {
            border-color: var(--primary-color);
        }

        .form-group button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }

        .form-group button:hover {
            background-color: var(--secondary-color);
        }

        .register-form {
            max-width: 600px;
            margin: 0 auto;
            background: linear-gradient(135deg, #e6f0fa, #f0f4f8);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 0 auto;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 500;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .rank-1 {
            background-color: #ffd700;
            font-weight: bold;
        }

        .rank-2 {
            background-color: #c0c0c0;
            font-weight: bold;
        }

        .rank-3 {
            background-color: #cd7f32;
            font-weight: bold;
            color: white;
        }

        .honor-table {
            width: 100%;
            margin-top: 20px;
        }

        .honor-table th, .honor-table td {
            text-align: center;
        }

        .honor-table .icon {
            font-size: 1.5rem;
            margin-right: 5px;
        }

        .error-message {
            color: var(--danger-color);
            text-align: center;
            padding: 15px;
            border: 1px solid var(--danger-color);
            border-radius: var(--border-radius);
            margin: 20px 0;
            background-color: #fdecea;
        }

        .success-message {
            color: var(--success-color);
            text-align: center;
            padding: 15px;
            border: 1px solid var(--success-color);
            border-radius: var(--border-radius);
            margin: 20px 0;
            background-color: #e8f5e9;
        }

        .last-updated {
            text-align: right;
            font-style: italic;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        .refresh-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
            display: block;
            margin: 0 auto 20px;
        }

        .refresh-btn:hover {
            background-color: var(--secondary-color);
        }

        footer {
            text-align: center;
            padding: 30px;
            background-color: #fff;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-top: 20px;
            color: #666;
        }

        footer p {
            margin: 5px 0;
        }

        @media (max-width: 768px) {
            th, td {
                padding: 10px;
                font-size: 0.9rem;
            }
            h1 {
                font-size: 2rem;
            }
            nav ul {
                flex-direction: column;
                gap: 10px;
            }
            nav ul li a {
                display: block;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>TRUNG TÂM IEMATH</h1>
            <div class="intro-text">Bồi dưỡng HSG, luyện thi THPT Quốc Gia, Luyện thi Toán 10 chuyên, Luyện thi tuyển sinh lớp 10</div>
        </header>

        <nav>
            <ul>
                <li><a href="#home" onclick="showSection('home')"><i class="fas fa-home"></i> Trang chủ</a></li>
                <li><a href="#register" onclick="showSection('register')"><i class="fas fa-user-plus"></i> Đăng ký học</a></li>
                <li><a href="#scores" onclick="showSection('scores')"><i class="fas fa-table"></i> Bảng điểm học sinh</a></li>
                <li><a href="#competition" onclick="showSection('competition')"><i class="fas fa-trophy"></i> Kết quả thi đua</a></li>
            </ul>
        </nav>

        <div class="banner">
            Bứt phá lên đỉnh cuối học kì 2
        </div>

        <div class="section active" id="home">
            <div class="home-section">
                <h2>Chào mừng đến với IEMATH</h2>
                <p>Trung tâm IEMATH tự hào là đơn vị hàng đầu trong việc bồi dưỡng học sinh giỏi, luyện thi THPT Quốc Gia, và chuẩn bị cho các kỳ thi quan trọng. Với đội ngũ giáo viên giàu kinh nghiệm và phương pháp giảng dạy hiện đại, chúng tôi cam kết mang đến môi trường học tập tốt nhất cho học sinh.</p>
                <h2>Bảng vinh danh học sinh</h2>
                <div class="table-container" id="honorTable">
                    <!-- Bảng vinh danh sẽ được thêm vào đây -->
                </div>
            </div>
        </div>

        <div class="section" id="register">
            <h2>Đăng ký học</h2>
            <div id="registerMessage" style="display: none;"></div>
            <form id="registerForm" class="register-form">
                <div class="form-group">
                    <label for="studentName">Tên học sinh <span style="color: red;">*</span></label>
                    <input type="text" id="studentName" required placeholder="Nhập tên học sinh">
                </div>
                <div class="form-group">
                    <label for="parentName">Tên phụ huynh</label>
                    <input type="text" id="parentName" placeholder="Nhập tên phụ huynh">
                </div>
                <div class="form-group">
                    <label for="class">Lớp</label>
                    <select id="class">
                        <option value="">Chọn lớp</option>
                        <option value="6">Lớp 6</option>
                        <option value="7">Lớp 7</option>
                        <option value="8">Lớp 8</option>
                        <option value="9">Lớp 9</option>
                        <option value="10">Lớp 10</option>
                        <option value="11">Lớp 11</option>
                        <option value="12">Lớp 12</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="subject">Môn học</label>
                    <select id="class">
                        <option value="">Chọn lớp</option>
                        <option value="Toán">Toán</option>
                        <option value="Lí Hóa">Lí Hóa</option>
                    </select>
                    //<input type="text" id="subject" placeholder="Nhập môn học">
                </div>
                <div class="form-group">
                    <label for="school">Trường</label>
                    <input type="text" id="school" placeholder="Nhập tên trường">
                </div>
                <div class="form-group">
                    <label for="address">Địa chỉ</label>
                    <input type="text" id="address" placeholder="Nhập địa chỉ">
                </div>
                <div class="form-group">
                    <label for="phone">Số điện thoại liên hệ <span style="color: red;">*</span></label>
                    <input type="tel" id="phone" required placeholder="Nhập số điện thoại">
                </div>
                <div class="form-group">
                    <label for="social">Zalo/Facebook</label>
                    <input type="text" id="social" placeholder="Nhập Zalo/Facebook">
                </div>
                <div class="form-group">
                    <button type="submit">Đăng ký</button>
                </div>
            </form>
        </div>

        <div class="section" id="scores">
            <h2>Bảng điểm học sinh</h2>
            <div class="form-group">
                <label for="scoreCode">Nhập mã học sinh để xem bảng điểm</label>
                <input type="text" id="scoreCode" placeholder="Ví dụ: HS001">
                <button onclick="loadScores()">Xem</button>
            </div>
            <div class="last-updated" id="scoreLastUpdated">Cập nhật lúc: Chưa tải dữ liệu</div>
            <button class="refresh-btn" onclick="loadScores()"><i class="fas fa-sync-alt"></i> Làm mới dữ liệu</button>
            <div id="scoreError" class="error-message" style="display: none;"></div>
            <div class="table-container" id="scoreTable">
                <!-- Bảng điểm sẽ được thêm vào đây -->
            </div>
        </div>

        <div class="section" id="competition">
            <h2>Kết quả thi đua</h2>
            <div class="form-group">
                <label for="competitionCode">Nhập mã lớp để xem kết quả thi đua</label>
                <input type="text" id="competitionCode" placeholder="Ví dụ: HSLH07">
                <button onclick="loadCompetition()">Xem</button>
            </div>
            <div class="last-updated" id="competitionLastUpdated">Cập nhật lúc: Chưa tải dữ liệu</div>
            <button class="refresh-btn" onclick="loadCompetition()"><i class="fas fa-sync-alt"></i> Làm mới dữ liệu</button>
            <div id="competitionError" class="error-message" style="display: none;"></div>
            <div class="table-container" id="competitionTable">
                <!-- Bảng kết quả thi đua sẽ được thêm vào đây -->
            </div>
        </div>

        <footer>
            <p><strong>Trung tâm IEMATH</strong></p>
            <p>Địa chỉ: Nguyễn Hữu Dực, KP Phú Thọ 2, TX Đông Hòa</p>
            <p>Số điện thoại: 035 4842 111</p>
            <p>Email: iemath88@.gmail.com</p>
        </footer>
    </div>

    <script>
        // API Key và Spreadsheet ID
        const apiKey = 'AIzaSyDeU6hRBATWrsagRwk4n80-K8ZhpOiYuaQ'; // Thay bằng API Key của bạn
        const spreadsheetId = '1Pu-iUUpGsofrBbInwmns7vLai1_gwmDEvbWvGnYjd8I';

        // Hiển thị section
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            if (sectionId === 'home') {
                loadHonorTable();
            }
        }

        // Hàm định dạng ngày giờ
        function formatDateTime(date) {
            const options = { 
                day: '2-digit', 
                month: '2-digit', 
                year: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                hour12: false
            };
            return new Intl.DateTimeFormat('vi-VN', options).format(date);
        }

        // Hàm tạo bảng
        function createTable(data, rankColumnIndex = -1) {
            console.log("Dữ liệu để tạo bảng:", data); // Debug dữ liệu
            const table = document.createElement('table');
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            data[0].forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            for (let i = 1; i < data.length; i++) {
                const row = document.createElement('tr');
                data[i].forEach((cell, index) => {
                    const td = document.createElement('td');
                    td.textContent = cell;
                    row.appendChild(td);
                });
                if (rankColumnIndex !== -1 && data[i][rankColumnIndex]) {
                    const rank = parseInt(data[i][rankColumnIndex]);
                    if (!isNaN(rank)) {
                        if (rank === 1) row.classList.add('rank-1');
                        else if (rank === 2) row.classList.add('rank-2');
                        else if (rank === 3) row.classList.add('rank-3');
                    }
                }
                tbody.appendChild(row);
            }
            table.appendChild(tbody);
            return table;
        }

        // Hàm tạo bảng vinh danh
        function createHonorTable(data) {
            console.log("Dữ liệu bảng vinh danh:", data); // Debug dữ liệu
            const table = document.createElement('table');
            table.className = 'honor-table';
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            ['Tên', 'Lớp', 'Xếp hạng', 'Thành tích'].forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            for (let i = 1; i < Math.min(data.length, 11); i++) { // Lấy tối đa 10 học sinh
                const row = document.createElement('tr');
                const rank = parseInt(data[i][2]);
                let icon = '';
                if (rank === 1) {
                    icon = '<i class="fas fa-trophy icon" style="color: #ffd700;"></i>';
                    row.classList.add('rank-1');
                } else if (rank === 2) {
                    icon = '<i class="fas fa-trophy icon" style="color: #c0c0c0;"></i>';
                    row.classList.add('rank-2');
                } else if (rank === 3) {
                    icon = '<i class="fas fa-trophy icon" style="color: #cd7f32;"></i>';
                    row.classList.add('rank-3');
                }
                row.innerHTML = `
                    <td>${data[i][0]}</td>
                    <td>${data[i][1]}</td>
                    <td>${icon}${data[i][2]}</td>
                    <td>${data[i][3]}</td>
                `;
                tbody.appendChild(row);
            }
            table.appendChild(tbody);
            return table;
        }

        // Hàm tải dữ liệu từ Google Sheets
        async function fetchSheetData(sheetName) {
            const encodedSheetName = encodeURIComponent(sheetName);
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${encodedSheetName}?key=${apiKey}`;
            console.log(`Gọi API cho sheet ${sheetName}: ${url}`); // Debug URL
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Lỗi khi gọi API: ${response.status} - ${response.statusText}. Chi tiết: ${errorText}`);
                }
                const data = await response.json();
                console.log(`Dữ liệu từ sheet ${sheetName}:`, data.values); // Debug dữ liệu
                return data.values;
            } catch (error) {
                console.error(`Lỗi khi tải dữ liệu từ sheet ${sheetName}:`, error);
                throw error;
            }
        }

        // Hàm tải bảng vinh danh
        async function loadHonorTable() {
            try {
                const data = await fetchSheetData('Vinh danh');
                if (!data || data.length === 0) {
                    throw new Error('Không có dữ liệu trong sheet Vinh danh');
                }
                const table = createHonorTable(data);
                document.getElementById('honorTable').innerHTML = '';
                document.getElementById('honorTable').appendChild(table);
            } catch (error) {
                document.getElementById('honorTable').innerHTML = `<div class="error-message">${error.message}</div>`;
            }
        }

        // Hàm tải bảng điểm
        async function loadScores() {
            const code = document.getElementById('scoreCode').value.trim(); // Loại bỏ khoảng trống
            const errorElement = document.getElementById('scoreError');
            const tableElement = document.getElementById('scoreTable');
            const lastUpdatedElement = document.getElementById('scoreLastUpdated');
            errorElement.style.display = 'none';
            tableElement.innerHTML = '';

            if (!code) {
                errorElement.textContent = 'Vui lòng nhập mã học sinh.';
                errorElement.style.display = 'block';
                return;
            }

            try {
                const data = await fetchSheetData('Bảng điểm');
                if (!data || data.length === 0) {
                    throw new Error('Không có dữ liệu trong sheet Bảng điểm');
                }

                console.log("Tiêu đề bảng điểm:", data[0]); // Debug tiêu đề
                const studentIdColumnIndex = data[0].indexOf('Mã học sinh');
                if (studentIdColumnIndex === -1) {
                    throw new Error('Không tìm thấy cột "Mã học sinh" trong bảng dữ liệu');
                }

                const filteredData = [data[0]]; // Giữ hàng tiêu đề
                for (let i = 1; i < data.length; i++) {
                    const studentId = data[i][studentIdColumnIndex] ? data[i][studentIdColumnIndex].trim() : '';
                    console.log(`So sánh mã học sinh: ${studentId} === ${code}`); // Debug so sánh
                    if (studentId === code) {
                        filteredData.push(data[i]);
                        break;
                    }
                }

                if (filteredData.length === 1) {
                    errorElement.textContent = 'Không tìm thấy mã học sinh này.';
                    errorElement.style.display = 'block';
                    return;
                }

                const table = createTable(filteredData);
                tableElement.appendChild(table);
                lastUpdatedElement.textContent = `Cập nhật lúc: ${formatDateTime(new Date())}`;
            } catch (error) {
                errorElement.textContent = error.message;
                errorElement.style.display = 'block';
            }
        }

        // Hàm tải kết quả thi đua
        async function loadCompetition() {
            const code = document.getElementById('competitionCode').value.trim(); // Loại bỏ khoảng trống
            const errorElement = document.getElementById('competitionError');
            const tableElement = document.getElementById('competitionTable');
            const lastUpdatedElement = document.getElementById('competitionLastUpdated');
            errorElement.style.display = 'none';
            tableElement.innerHTML = '';

            if (!code) {
                errorElement.textContent = 'Vui lòng nhập mã lớp.';
                errorElement.style.display = 'block';
                return;
            }

            try {
                const sheetName = 'HK2T3'; // Sửa tên sheet thành HK2T3
                const data = await fetchSheetData(sheetName);
                if (!data || data.length === 0) {
                    throw new Error(`Không có dữ liệu trong sheet ${sheetName}`);
                }

                console.log("Tiêu đề kết quả thi đua:", data[0]); // Debug tiêu đề
                const classColumnIndex = data[0].indexOf('Mã lớp');
                if (classColumnIndex === -1) {
                    throw new Error('Không tìm thấy cột "Mã lớp" trong bảng dữ liệu');
                }

                // Lọc dữ liệu và loại bỏ cột Mã lớp
                const filteredHeaders = data[0].filter((_, index) => index !== classColumnIndex);
                const filteredData = [filteredHeaders];
                let matchFound = false;
                for (let i = 1; i < data.length; i++) {
                    const classCode = data[i][classColumnIndex] ? data[i][classColumnIndex].trim() : '';
                    console.log(`So sánh mã lớp: "${classCode}" === "${code}"`); // Debug so sánh
                    if (classCode === code) {
                        const rowData = data[i].filter((_, index) => index !== classColumnIndex);
                        filteredData.push(rowData);
                        matchFound = true;
                    }
                }

                if (!matchFound || filteredData.length === 1) {
                    errorElement.textContent = 'Không tìm thấy dữ liệu cho mã lớp này.';
                    errorElement.style.display = 'block';
                    return;
                }

                const rankColumnIndex = filteredHeaders.indexOf('Xếp hạng');
                const table = createTable(filteredData, rankColumnIndex);
                tableElement.appendChild(table);
                lastUpdatedElement.textContent = `Cập nhật lúc: ${formatDateTime(new Date())}`;
            } catch (error) {
                errorElement.textContent = error.message;
                errorElement.style.display = 'block';
            }
        }

        // Hàm kiểm tra định dạng số điện thoại
        function validatePhoneNumber(phone) {
            const phonePattern = /^[0-9]{10,11}$/; // Định dạng: 10 hoặc 11 số
            return phonePattern.test(phone);
        }

        // Xử lý form đăng ký
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const messageElement = document.getElementById('registerMessage');
            messageElement.style.display = 'none';

            // Lấy dữ liệu từ form
            const formData = new FormData();
            formData.append('studentName', document.getElementById('studentName').value.trim());
            formData.append('parentName', document.getElementById('parentName').value.trim());
            formData.append('class', document.getElementById('class').value);
            formData.append('subject', document.getElementById('subject').value.trim());
            formData.append('school', document.getElementById('school').value.trim());
            formData.append('address', document.getElementById('address').value.trim());
            formData.append('phone', document.getElementById('phone').value.trim());
            formData.append('social', document.getElementById('social').value.trim());
            formData.append('timestamp', new Date().toISOString());

            // Kiểm tra dữ liệu đầu vào
            if (!formData.get('studentName')) {
                messageElement.textContent = 'Vui lòng nhập tên học sinh.';
                messageElement.className = 'error-message';
                messageElement.style.display = 'block';
                return;
            }

            if (!formData.get('phone')) {
                messageElement.textContent = 'Vui lòng nhập số điện thoại.';
                messageElement.className = 'error-message';
                messageElement.style.display = 'block';
                return;
            }

            if (!validatePhoneNumber(formData.get('phone'))) {
                messageElement.textContent = 'Số điện thoại không hợp lệ. Vui lòng nhập 10 hoặc 11 số.';
                messageElement.className = 'error-message';
                messageElement.style.display = 'block';
                return;
            }

            console.log('Dữ liệu gửi đi:', Object.fromEntries(formData)); // Debug dữ liệu gửi

            try {
                const webAppUrl = 'https://script.google.com/macros/s/AKfycbxlOuTPqy3iufaY2kOAqdhh4buNF2ZkFO0AMUMtsE_t7pLrm5gRkq97vcFT45Z58i4/exec'; // Thay bằng URL Web App của bạn
                const response = await fetch(webAppUrl, {
                    method: 'POST',
                    body: formData // Sử dụng FormData thay vì JSON
                    // Không cần headers 'Content-Type', fetch sẽ tự động đặt thành 'multipart/form-data'
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`Lỗi khi gửi dữ liệu: ${response.status} - ${response.statusText}. Chi tiết: ${errorText}`);
                }

                const result = await response.json();
                console.log('Phản hồi từ Apps Script:', result); // Debug phản hồi

                if (result.status === 'success') {
                    messageElement.textContent = 'Đăng ký thành công! Chúng tôi sẽ liên hệ với bạn sớm.';
                    messageElement.className = 'success-message';
                    messageElement.style.display = 'block';
                    this.reset(); // Xóa form sau khi đăng ký thành công
                } else {
                    messageElement.textContent = 'Đăng ký thất bại: ' + result.message;
                    messageElement.className = 'error-message';
                    messageElement.style.display = 'block';
                }
            } catch (error) {
                console.error('Lỗi khi gửi dữ liệu:', error); // Debug lỗi
                messageElement.textContent = 'Lỗi khi gửi dữ liệu: ' + error.message;
                messageElement.className = 'error-message';
                messageElement.style.display = 'block';
            }
        });

        // Tải bảng vinh danh khi trang được tải
        loadHonorTable();
    </script>
</body>
</html>
